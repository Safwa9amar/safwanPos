import { UserRole, SubscriptionStatus } from "./enums.prisma"

model User {
  id                String      @id @default(cuid())
  name              String?
  email             String      @unique
  password          String
  emailVerified     DateTime?
  emailVerificationToken String? @unique
  image             String?
  createdAt         DateTime    @default(now())
  updatedAt         DateTime    @updatedAt
  role              UserRole    @default(CASHIER)
  
  subscriptionStatus SubscriptionStatus @default(TRIAL)
  trialEndsAt        DateTime?
  
  passwordResetToken         String?   @unique
  passwordResetTokenExpires  DateTime?

  companyProfile    CompanyProfile?

  sales             Sale[]
  customers         Customer[]
  products          Product[]
  categories        Category[]
  barcodes          Barcode[]
  suppliers         Supplier[]
  purchaseOrders    PurchaseOrder[]
  supplierPayments  SupplierPayment[]
  supplierCredits   SupplierCredit[]
  directPurchases   DirectPurchase[]
  purchasePriceHistory PurchasePriceHistory[]
  expenses          Expense[]
  expenseCategories ExpenseCategory[]
  capitalEntries    CapitalEntry[]
  reports           Report[]
  repairJobs        RepairJob[]
  
  createdById       String?
  createdBy         User?       @relation("CreatedUsers", fields: [createdById], references: [id], onDelete: SetNull)
  createdUsers      User[]      @relation("CreatedUsers")
}


model CompanyProfile {
  id            String    @id @default(cuid())
  userId        String    @unique
  user          User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  name          String?
  logoUrl       String?
  address       String?
  phone         String?
  email         String?
  website       String?
  
  taxId1Label   String?
  taxId1Value   String?
  taxId2Label   String?
  taxId2Value   String?

  invoiceTitle  String?
  invoiceFooter String?
  
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
}
