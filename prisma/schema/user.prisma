/// Represents a user account in the system.
model User {
  id        String   @id @default(cuid())
  name      String?
  email     String   @unique
  password  String
  role      UserRole @default(CASHIER)
  
  // Email Verification
  emailVerified           DateTime?
  emailVerificationToken  String?   @unique

  // Password Reset
  passwordResetToken          String?   @unique
  passwordResetTokenExpires   DateTime?

  // Tenancy: Who created this user?
  createdById String?
  createdBy   User?   @relation("UserCreations", fields: [createdById], references: [id], onDelete: NoAction, onUpdate: NoAction)
  createdUsers User[] @relation("UserCreations")

  // Subscription Details
  subscriptionStatus      SubscriptionStatus @default(TRIAL)
  trialEndsAt             DateTime?

  // User-owned data
  products             Product[]
  categories           Category[]
  barcodes             Barcode[]
  sales                Sale[]
  customers            Customer[]
  payments             Payment[]
  suppliers            Supplier[]
  supplierPayments     SupplierPayment[]
  supplierCredits      SupplierCredit[]
  purchaseOrders       PurchaseOrder[]
  directPurchases      DirectPurchase[]
  purchasePriceHistory PurchasePriceHistory[]
  expenses             Expense[]
  expenseCategories    ExpenseCategory[]
  capitalEntries       CapitalEntry[]
  repairJobs           RepairJob[]
  reports              Report[]
  companyProfile       CompanyProfile?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}


/// Stores company-specific information for a user, used for branding invoices.
model CompanyProfile {
  id           String  @id @default(cuid())
  user         User    @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId       String  @unique
  
  name         String?
  logoUrl      String?
  address      String?
  phone        String?
  email        String?
  website      String?
  
  taxId1Label  String?
  taxId1Value  String?
  taxId2Label  String?
  taxId2Value  String?
  
  invoiceTitle String?
  invoiceFooter String? @db.Text
}
