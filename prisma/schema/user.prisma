/// User, authentication, and session-related models

model User {
  id                        String    @id @default(cuid())
  name                      String?
  email                     String    @unique
  emailVerified             DateTime?
  password                  String
  role                      UserRole  @default(ADMIN)
  createdAt                 DateTime  @default(now())
  updatedAt                 DateTime  @updatedAt
  subscriptionStatus        SubscriptionStatus?
  trialEndsAt               DateTime?
  emailVerificationToken    String?   @unique
  passwordResetToken        String?   @unique
  passwordResetTokenExpires DateTime?
  createdById               String?
  createdBy                 User?     @relation("UserCreations", fields: [createdById], references: [id], onDelete: SetNull)
  createdUsers              User[]    @relation("UserCreations")
  companyProfile CompanyProfile?

  sales         Sale[]
  reports       Report[]
  barcodes      Barcode[]
  categories    Category[]
  products      Product[]
  customers     Customer[]
  payments      Payment[]
  expenseCategories ExpenseCategory[]
  expenses      Expense[]
  capitalEntries CapitalEntry[]
  repairJobs    RepairJob[]
  suppliers     Supplier[]
  purchaseOrders PurchaseOrder[]
  supplierPayments SupplierPayment[]
  supplierCredits  SupplierCredit[]
  directPurchases  DirectPurchase[]

  @@index([createdById])
}

model Report {
  id        String   @id @default(cuid())
  title     String
  content   String   @db.Text
  userId    String
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  createdAt DateTime @default(now())

  @@index([userId])
}

enum UserRole {
  ADMIN
  CASHIER
  PHONE_REPAIR
}

enum SubscriptionStatus {
  TRIAL
  ACTIVE
  INACTIVE
  CANCELED
}
model CompanyProfile {
  id String @id @default(cuid())

  name          String?
  logoUrl       String?
  address       String?
  phone         String?
  email         String?
  website       String?
  taxId1Label   String?
  taxId1Value   String?
  taxId2Label   String?
  taxId2Value   String?
  invoiceTitle  String?
  invoiceFooter String?

  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId String @unique

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
