import { User } from "./user.prisma"
import { Sale } from "./sale.prisma"

/// Represents a customer of the business.
model Customer {
  id      String    @id @default(cuid())
  name    String
  phone   String?
  email   String?   @unique
  address String?
  balance Float     @default(0) // Positive means customer owes money
  sales   Sale[]
  payments Payment[]

  userId String
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([userId])
}

/// Represents a payment made by a customer.
model Payment {
  id          String   @id @default(cuid())
  customerId  String
  customer    Customer @relation(fields: [customerId], references: [id], onDelete: Cascade)
  amount      Float
  paymentDate DateTime @default(now())
  notes       String?

  userId String
  user   User   @relation(fields: [userId], references: [id]) // No cascade delete, keep payment history

  @@index([customerId])
  @@index([userId])
}
