// /prisma/schema/supplier.prisma

model Supplier {
  id                      String      @id @default(cuid())
  name                    String
  contactName             String?
  email                   String?
  phone                   String?
  address                 String?
  taxId                   String?
  balance                 Float       @default(0)
  status                  SupplierStatus @default(ACTIVE)
  logoUrl                 String?
  category                String?
  paymentTerms            String?
  deliverySchedule        String?
  communicationChannel    String?
  contractStartDate       DateTime?
  contractEndDate         DateTime?
  monthlySupplyQuota      Float?
  qualityRating           Int?
  notes                   String?
  
  createdAt               DateTime    @default(now())
  updatedAt               DateTime    @updatedAt

  userId                  String
  user                    User        @relation(fields: [userId], references: [id], onDelete: Cascade)

  purchaseOrders          PurchaseOrder[]
  payments                SupplierPayment[]
  credits                 SupplierCredit[]

  @@index([userId])
}

model SupplierPayment {
  id            String   @id @default(cuid())
  paymentDate   DateTime @default(now())
  amount        Float
  notes         String?

  userId        String
  user          User     @relation(fields: [userId], references: [id])

  supplierId    String
  supplier      Supplier @relation(fields: [supplierId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([supplierId])
}

model SupplierCredit {
  id              String   @id @default(cuid())
  adjustmentDate  DateTime @default(now())
  amount          Float
  reason          String

  userId          String
  user            User     @relation(fields: [userId], references: [id])

  supplierId      String
  supplier        Supplier @relation(fields: [supplierId], references: [id], onDelete: Cascade)
  
  @@index([userId])
  @@index([supplierId])
}
