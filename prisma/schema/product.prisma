
/// Represents a product in the inventory.
model Product {
  id           String    @id @default(cuid())
  name         String
  price        Float
  stock        Float
  unit         ProductUnit @default(EACH)
  image        String?
  productionDate DateTime?
  expiryDate   DateTime?

  barcodes     Barcode[]
  saleItems    SaleItem[]
  category     Category? @relation(fields: [categoryId], references: [id], onDelete: SetNull)
  categoryId   String?
  
  purchaseOrderItems DirectPurchaseItem[]
  directPurchaseItems PurchaseOrderItem[]

  priceHistory PurchasePriceHistory[]

  userId String
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([userId])
  @@index([categoryId])
}

/// Represents a product category.
model Category {
  id       String    @id @default(cuid())
  name     String
  products Product[]
  userId   String
  user     User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([name, userId])
  @@index([userId])
}

/// Represents a barcode associated with a product.
model Barcode {
  id        String  @id @default(cuid())
  code      String
  product   Product @relation(fields: [productId], references: [id], onDelete: Cascade)
  productId String

  userId String
  user   User   @relation(fields: [userId], references: [id])

  @@unique([code, userId])
  @@index([productId])
  @@index([userId])
}
